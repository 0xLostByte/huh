<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ØªØ­Ø¯ÙŠ Ù„Ø¤ÙŠ</title>
<style>
    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙØ­Ø© */
    body {
        margin: 0; padding: 0; height: 100vh;
        background: black;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        overflow: hidden; color: white;
        text-align: center; display: flex;
        justify-content: center; align-items: center;
    }

    /* Ø²Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ */
    #start-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8); z-index: 1000;
        display: none;
        flex-direction: column; justify-content: center; align-items: center;
        cursor: pointer;
    }
    .start-btn {
        padding: 20px 40px; font-size: 24px; font-weight: bold;
        background: #ff4d6d; color: white; border: none;
        border-radius: 50px; cursor: pointer;
        box-shadow: 0 0 20px rgba(255, 77, 109, 0.6);
        animation: pulse 1.5s infinite;
    }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

    /* Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ù„Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ©) */
    #mainVideo { 
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
        object-fit: cover; z-index: 10; display: none; 
    }
    
    /* Ø§Ù„Ø­ÙˆØ§Ø± */
    #dialogueOverlay { 
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
        background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); 
        z-index: 20; display: none; flex-direction: column; 
        justify-content: center; align-items: center; padding: 20px; 
    }
    .dialogue-text { font-size: 30px; font-weight: bold; color: #fff; text-shadow: 0 0 10px #ff69b4; opacity: 0; transition: opacity 0.5s; }

    /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© */
    .glass-box { position: relative; z-index: 30; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border-radius: 20px; padding: 20px; width: 90%; max-width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.3); display: none; transition: transform 0.3s; }
    .timer { font-size: 40px; font-weight: bold; color: #ffeb3b; margin-bottom: 15px; }
    .question { font-size: 24px; margin-bottom: 25px; font-weight: bold; line-height: 1.4; }
    
    .option-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; background: rgba(255,255,255,0.9); color: #333; border: none; border-radius: 12px; font-size: 18px; cursor: pointer; transition: 0.2s; }
    .option-btn:active { transform: scale(0.95); }

    /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£) */
    .correct-highlight {
        background-color: #2ecc71 !important; /* Ø£Ø®Ø¶Ø± */
        color: white !important;
        box-shadow: 0 0 15px #2ecc71;
        transform: scale(1.05);
    }
    /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø© */
    .wrong-highlight {
        background-color: #e74c3c !important; /* Ø£Ø­Ù…Ø± */
        color: white !important;
    }

    /* Ù†Øµ Ø§Ù„Ù…Ø¯Ø­ */
    #praiseText {
        color: white; font-size: 28px; font-weight: bold;
        text-shadow: 0 0 15px #fff, 0 0 20px #ff4d6d;
        margin-bottom: 15px; display: none;
        animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    
    /* Ù†Ø§ÙØ°Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø±Ø¨Ø¹ (Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£) */
    #wrongPopup {
        position: fixed;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        width: 280px; height: 280px;
        background: black;
        border: 8px solid black; /* Ø­ÙˆØ§Ù Ø³ÙˆØ¯Ø§Ø¡ */
        border-radius: 15px;
        box-shadow: 0 0 30px rgba(0,0,0,0.8); /* Ø¸Ù„ Ù‚ÙˆÙŠ */
        z-index: 200;
        display: none;
        overflow: hidden;
    }
    #wrongVideo { width: 100%; height: 100%; object-fit: cover; }

    /* Ø§Ù„Ù…Ù‚Ø§Ù„Ø¨ ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
    .ad-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: black; z-index: 50; display: none; flex-direction: column; justify-content: center; align-items: center; }
    .ad-overlay video { width: 100%; height: auto; object-fit: contain; }
    .skip-btn { position: absolute; bottom: 30px; right: 20px; background: rgba(0,0,0,0.6); color: white; padding: 12px 25px; border: 1px solid white; border-radius: 5px; cursor: pointer; display: none; z-index: 60; font-size: 16px; }
    
    #loay-chat { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.85); padding: 15px 25px; border-radius: 25px; font-size: 18px; color: #00ffea; z-index: 100; display: none; width: 85%; text-align: center; border: 1px solid #00ffea; }
    
    .virus-popup { position: fixed; background: red; color: white; padding: 20px; font-weight: bold; font-size: 20px; border: 3px solid yellow; z-index: 200; animation: shake 0.5s infinite; box-shadow: 5px 5px 15px black; }
    @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } }

    /* ÙƒØ§Ù†ÙØ§Ø³ Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ */
    #confettiCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1000; }
</style>
</head>
<body>

<audio id="yayAudio" src="yay.mp3"></audio>
<audio id="partyAudio" src="party.mp3"></audio>

<canvas id="confettiCanvas"></canvas>

<div id="wrongPopup">
    <video id="wrongVideo" src="wrong.mp4" playsinline></video>
</div>

<div id="start-overlay">
    <button class="start-btn" onclick="playForcedManually()">ØªØ¹Ø¨ÙŠ Ø§ÙŠØ¯Ùƒ Ø§Ù„Ø­Ù„ÙˆÙ‡ Ùˆ Ø§Ø¶ØºØ·ÙŠ</button>
</div>

<video id="mainVideo" playsinline></video>

<div id="dialogueOverlay">
    <div class="dialogue-text" id="dialogueText"></div>
</div>

<div class="glass-box" id="quizBox">
    <div id="praiseText">Ø´Ø§Ø·Ø±Ù‡ ÙŠ Ø±ÙˆØ­ÙŠ â¤ï¸</div>
    <div class="timer" id="timer">60</div>
    <div class="question" id="qText"></div>
    <div id="options"></div>
</div>

<div class="ad-overlay" id="adLayer">
    <h3 style="position:absolute; top:20px; left:20px; color:yellow; z-index:55;">Ø¥Ø¹Ù„Ø§Ù† Ø¥Ø¬Ø¨Ø§Ø±ÙŠ</h3>
    <video id="adVideo" src="ad1.mp4" loop playsinline muted></video>
    <div class="skip-btn" id="skipBtn" onclick="handleSkipClick()">Skip Ad</div>
</div>

<div id="loay-chat"></div>

<script>
    const status = sessionStorage.getItem("meStatus");
    const startOverlay = document.getElementById("start-overlay");
    const mainVideo = document.getElementById("mainVideo");
    
    const dialogueOverlay = document.getElementById("dialogueOverlay");
    const dialogueText = document.getElementById("dialogueText");
    const quizBox = document.getElementById("quizBox");
    const adLayer = document.getElementById("adLayer");
    const skipBtn = document.getElementById("skipBtn");
    const loayChat = document.getElementById("loay-chat");
    const adVideo = document.getElementById("adVideo");
    
    const yayAudio = document.getElementById("yayAudio");
    const partyAudio = document.getElementById("partyAudio");
    const praiseText = document.getElementById("praiseText");
    
    // Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ù„Ù„Ø®Ø·Ø£
    const wrongPopup = document.getElementById("wrongPopup");
    const wrongVideo = document.getElementById("wrongVideo");

    const questions = [
        { q: "Ø´ÙŠØ¡ ÙƒÙ„Ù…Ø§ Ø£Ø®Ø°Øª Ù…Ù†Ù‡ ÙƒØ¨Ø±ØŒ Ù…Ø§ Ù‡ÙˆØŸ", opts: ["Ø§Ù„Ø¹Ù…Ø±", "Ø§Ù„Ø­ÙØ±Ø©", "Ø§Ù„Ù…Ø§Ù„"], ans: 1, time: 60 },
        { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø­ÙŠÙˆØ§Ù† Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠÙ„Ø¯ ÙˆÙ„Ø§ ÙŠØ¨ÙŠØ¶ØŸ", opts: ["Ø°ÙƒØ± Ø§Ù„Ø­ÙŠÙˆØ§Ù†", "Ø§Ù„Ø¨ØºÙ„", "Ø§Ù„ÙˆØ·ÙˆØ§Ø·"], ans: 0, time: 40 },
        { q: "Ø­Ø§ØµÙ„ Ø¶Ø±Ø¨ 8 Ã— 8 + 4ØŸ", opts: ["64", "68", "72"], ans: 1, time: 30 },
        { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ ÙŠÙƒØªØ¨ ÙˆÙ„Ø§ ÙŠÙ‚Ø±Ø£ØŸ", opts: ["Ø§Ù„Ù‚Ù„Ù…", "Ø§Ù„Ø³Ø§Ø¹Ø©", "Ø§Ù„ÙƒØªØ§Ø¨"], ans: 0, time: 20 },
        { q: "Ø¨Ø³Ø±Ø¹Ø©! 50 Ã· 2 + 5ØŸ", opts: ["30", "25", "35"], ans: 0, time: 10 }
    ];

    let qIndex = 0;
    let timerInterval;
    let adStage = 1;

    window.onload = function() {
        mainVideo.style.display = "block";
        resizeCanvas();

        if (status === 'forced') {
            startOverlay.style.display = "flex";
            mainVideo.src = "forced.mp4";
        } else {
            startOverlay.style.display = "none";
            startLoveScenario();
        }
    };
    
    window.onresize = resizeCanvas;

    function playForcedManually() {
        startOverlay.style.display = "none";
        mainVideo.muted = false;
        mainVideo.play();
        mainVideo.onended = () => {
            mainVideo.style.display = "none";
            showDialogueSequence([
                { text: "Ù…Ø§ ØªÙˆÙ‚Ø¹Øª Ø§Ù†Ùˆ Ø§ÙƒÙˆÙ† Ø§Ø®Ø± ÙˆØ§Ø­Ø¯ğŸ˜”", time: 3000 },
                { text: "ÙÙŠ Ø§Ø³Ø¦Ù„Ù‡ Ù„Ø§Ø²Ù… ØªØ¬Ø§ÙˆØ¨ÙŠ Ø¹Ù„ÙŠÙ‡Ø§ Ù‡ÙŠÙ‡ÙŠ", time: 3000 },
                { text: "good luck", time: 2000 }
            ]);
        };
    }

    function startLoveScenario() {
        mainVideo.src = "homer.mp4";
        mainVideo.muted = true;
        var p = mainVideo.play();
        if(p !== undefined){
            p.then(_=>{ setTimeout(()=>{ mainVideo.muted = false; }, 1000); }).catch(e=>{ console.log("Autoplay blocked"); });
        }
        mainVideo.onended = () => {
            mainVideo.src = "kiss.mp4";
            mainVideo.muted = false;
            mainVideo.play();
            mainVideo.onended = () => {
                mainVideo.style.display = "none";
                showDialogueSequence([
                    { text: "Ù†ÙˆØ±ØªÙŠ ÙŠ Ø¹ÙŠÙˆÙ†ÙŠ ÙƒÙ…Ø§Ù† Ù…Ø±Ù‡", time: 3000 },
                    { text: "Ø´ÙˆÙÙŠ Ø¨ÙŠÙƒÙˆÙ† ÙÙŠ Ø§Ø³Ø¦Ù„Ù‡ Ù„Ø§Ø²Ù… ØªØ¬Ø§ÙˆØ¨ÙŠ Ø¹Ù„ÙŠÙ‡Ø§ ÙˆØ§Ø­Ø¨Ùƒ", time: 3000 },
                    { text: "ÙˆØµØ­ Ø§Ù†ØªØ¨Ù‡ÙŠ ØªØ¬Ø§ÙˆØ¨ÙŠ ØºÙ„Ø·", time: 5000 }, 
                    { text: "good luck", time: 2000 }
                ]);
            };
        };
    }

    function showDialogueSequence(messages) {
        dialogueOverlay.style.display = "flex";
        let i = 0;
        function showNext() {
            if (i < messages.length) {
                dialogueText.style.opacity = 0;
                dialogueText.innerText = messages[i].text;
                setTimeout(() => { dialogueText.style.opacity = 1; }, 100);
                setTimeout(() => { i++; showNext(); }, messages[i].time);
            } else {
                dialogueOverlay.style.display = "none";
                startQuiz();
            }
        }
        showNext();
    }

    function startQuiz() {
        document.body.style.background = "linear-gradient(135deg, #1e3c72, #2a5298, #ff7a8a)";
        quizBox.style.display = "block";
        loadQuestion();
    }

    function loadQuestion() {
        praiseText.style.display = "none";
        
        // Ø¥Ø²Ø§Ù„Ø© Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
        const oldBtns = document.querySelectorAll('.option-btn');
        oldBtns.forEach(btn => {
            btn.classList.remove('correct-highlight', 'wrong-highlight');
        });

        if (qIndex === 3 && adStage === 1) { 
            triggerAdSequence(); 
            return; 
        }

        if (qIndex >= questions.length) {
            alert("Ø®Ù„ØµØªÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©! Ø±ÙˆØ­ÙŠ Ù„ØµÙØ­Ø© Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©"); 
            return; 
        } 

        const q = questions[qIndex];
        document.getElementById("qText").innerText = q.q;
        const optsDiv = document.getElementById("options");
        optsDiv.innerHTML = "";
        
        let timeLeft = q.time;
        document.getElementById("timer").innerText = timeLeft;
        
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft--;
            document.getElementById("timer").innerText = timeLeft;
            if(timeLeft <= 0) { clearInterval(timerInterval); playPunishment(-1); } // -1 ÙŠØ¹Ù†ÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ù‰
        }, 1000);

        q.opts.forEach((opt, idx) => {
            const btn = document.createElement("button");
            btn.className = "option-btn";
            btn.innerText = opt;
            // Ù†Ù…Ø±Ø± Ø§Ù„Ù€ idx Ø¹Ø´Ø§Ù† Ù†Ø¹Ø±Ù Ø£ÙŠ Ø²Ø± Ø¶ØºØ·Øª
            btn.onclick = () => checkAnswer(idx, q.ans);
            optsDiv.appendChild(btn);
        });
    }

    function checkAnswer(selected, correct) {
        clearInterval(timerInterval);
        
        if (selected === correct) { 
            // ----- Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© -----
            yayAudio.currentTime = 0; yayAudio.play();
            partyAudio.currentTime = 0; partyAudio.play();
            praiseText.style.display = "block";
            fireConfetti();
            
            // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø²Ø± Ø¨Ø§Ù„Ø£Ø®Ø¶Ø±
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns[selected].classList.add('correct-highlight');

            setTimeout(() => { qIndex++; loadQuestion(); }, 3000);
            
        } else { 
            // ----- Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø© -----
            playPunishment(selected, correct); 
        }
    }

    function playPunishment(selectedIndex, correctIndex) {
        const allBtns = document.querySelectorAll('.option-btn');
        
        // 1. ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ø§Ù„Ø£Ø®Ø¶Ø±
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø®Ø·Ø£ Ø¨Ø³Ø¨Ø¨ Ø§Ù„ÙˆÙ‚Øª (selectedIndex = -1) Ù†Ù„ÙˆÙ† Ø§Ù„ØµØ­ÙŠØ­Ø© ÙÙ‚Ø·
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø®Ø·Ø£ Ø¨Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ù†Ù„ÙˆÙ† Ø§Ù„Ø§Ø«Ù†ÙŠÙ†
        
        // Ù†Ù„ÙˆÙ† Ø§Ù„ØµØ­ÙŠØ­Ø©
        if (correctIndex !== undefined) {
             allBtns[correctIndex].classList.add('correct-highlight');
        } else {
             // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚ØªØŒ Ù„Ø§Ø²Ù… Ù†Ø¹Ø±Ù Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
             const q = questions[qIndex];
             allBtns[q.ans].classList.add('correct-highlight');
        }

        // Ù†Ù„ÙˆÙ† Ø§Ù„Ø®Ø§Ø·Ø¦Ø© Ø¨Ø§Ù„Ø£Ø­Ù…Ø± (Ø¥Ø°Ø§ Ø§Ø®ØªØ§Ø±Øª Ø²Ø±)
        if (selectedIndex !== -1 && selectedIndex !== undefined) {
            allBtns[selectedIndex].classList.add('wrong-highlight');
        }

        // 2. ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø±Ø¨Ø¹
        wrongPopup.style.display = "block";
        wrongVideo.currentTime = 0;
        wrongVideo.play();
        
        // Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØµØºÙŠØ±
        wrongVideo.onended = () => {
            wrongPopup.style.display = "none";
            // Ù†Ø¹ÙŠØ¯ Ù†ÙØ³ Ø§Ù„Ø³Ø¤Ø§Ù„
            loadQuestion(); 
        };
    }

    function triggerAdSequence() {
        quizBox.style.display = "none";
        adLayer.style.display = "flex";
        adVideo.src = "ad1.mp4"; 
        adVideo.muted = false;
        adVideo.play();
        startSkipCountdown();
    }

    function startSkipCountdown() {
        let count = 5;
        skipBtn.style.display = "block";
        skipBtn.style.pointerEvents = "none"; 
        skipBtn.style.background = "rgba(0,0,0,0.6)";
        skipBtn.style.color = "white";
        skipBtn.innerText = "Skip in " + count;
        
        const countdown = setInterval(() => {
            count--;
            skipBtn.innerText = "Skip in " + count;
            if(count <= 0) {
                clearInterval(countdown);
                skipBtn.innerText = "Skip Ad >>";
                skipBtn.style.background = "yellow"; 
                skipBtn.style.color = "black";
                skipBtn.style.pointerEvents = "auto"; 
            }
        }, 1000);
    }

    let skipAttempts = 0;
    function handleSkipClick() {
        const btn = document.getElementById("skipBtn");
        if (adStage === 1) {
            skipAttempts++;
            if (skipAttempts === 1) {
                showChat("Ø·Ù„Ø¹ ÙÙŠ Ù…Ø´ÙƒÙ„Ù‡ ..");
                btn.style.pointerEvents = "none"; btn.style.background = "grey";
                setTimeout(() => { showChat("ÙˆÙŠØª Ø®Ù„ÙŠÙ†ÙŠ Ø§Ø­Ù„Ù‡Ø§ .."); }, 1500);
                setTimeout(() => { showChat("Ø¬Ø±Ø¨ÙŠ"); btn.style.pointerEvents = "auto"; btn.style.background = "yellow"; }, 4500);
            } else if (skipAttempts >= 2) {
                showChat(""); adStage = 2; adVideo.src = "ad2.mp4"; adVideo.play(); startSkipCountdown();
            }
        } else if (adStage === 2) {
            adLayer.style.display = "none"; quizBox.style.display = "block"; showChat(""); loadQuestion();
        }
    }

    function showChat(text) {
        if(text === "") { loayChat.style.display = "none"; return; }
        loayChat.style.display = "block";
        loayChat.innerText = "Ù„Ø¤ÙŠ: " + text;
    }

    // ================== Ù…Ù†Ø·Ù‚ Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ ==================
    const canvas = document.getElementById("confettiCanvas");
    const ctx = canvas.getContext("2d");
    let particles = [];

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    function fireConfetti() {
        const colors = ['#ff4d6d', '#ffeb3b', '#00ffea', '#ff69b4', '#ffffff'];
        for (let i = 0; i < 100; i++) {
            particles.push({
                x: canvas.width / 2,
                y: canvas.height + 20,
                vx: (Math.random() - 0.5) * 15,
                vy: -(Math.random() * 15 + 10),
                color: colors[Math.floor(Math.random() * colors.length)],
                size: Math.random() * 10 + 5,
                gravity: 0.5,
                rotation: Math.random() * 360,
                rotationSpeed: (Math.random() - 0.5) * 10
            });
        }
        updateConfetti();
    }

    function updateConfetti() {
        if (particles.length === 0) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < particles.length; i++) {
            let p = particles[i];
            p.x += p.vx; p.y += p.vy; p.vy += p.gravity; p.rotation += p.rotationSpeed;
            ctx.save();
            ctx.translate(p.x, p.y);
            ctx.rotate((p.rotation * Math.PI) / 180);
            ctx.fillStyle = p.color;
            ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);
            ctx.restore();
        }
        particles = particles.filter(p => p.y < canvas.height + 50);
        requestAnimationFrame(updateConfetti);
    }
</script>
</body>
</html>